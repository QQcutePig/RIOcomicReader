<!DOCTYPE html>
<html lang="zh-HK">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RIOcomicReader</title>
	<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200">
<link rel="stylesheet" href="style.css">

    <link rel="stylesheet" href="style.css">
</head>
<body>
    <!-- 書架模式 -->
    <div id="library-view" class="view active">
<header class="header">
    <h1>📚 RIOcomicReader</h1>
    
    <!-- 🆕 搜尋和排序 -->
<div class="header-center">
    <div class="search-box">
        <input type="text" id="search-input" placeholder="🔍 搜尋漫畫...">
        <button id="clear-search-btn" class="clear-search-btn" style="display: none;">✕</button>
    </div>
    <select id="sort-select">
            <option value="name">📚 書名排序</option>
            <option value="recent">⏰ 最近閱讀</option>
            <option value="progress">📊 閱讀進度</option>
        </select>
    </div>
    
    <div class="header-actions">
        <div class="view-size-buttons">
		<button id="view-small" class="btn-icon" title="小尺寸">📕</button>
            <button id="view-medium" class="btn-icon active" title="中尺寸">📗</button>
            <button id="view-large" class="btn-icon" title="大尺寸">📘</button>
        </div>
        <button id="theme-toggle" class="btn-icon" title="切換主題">🌙</button>
    </div>
</header>

        <div id="library-grid" class="library-grid">
            <div class="empty-state">
                <p>📂 尚未掃描漫畫</p>
                <p class="hint">點擊「掃描漫畫」選擇 comics 資料夾</p>
            </div>
        </div>

        <!-- 主頁工具列 -->
        <div id="library-toolbar" class="toolbar">
			<button id="lib-settings-btn" class="tool-btn" title="設定">⚙️</button>
            <button id="lib-rescan-btn" class="tool-btn" title="重新掃描">📂</button>
            <button id="lib-stats-btn" class="tool-btn" title="統計">📊</button>
            <button id="lib-bookmarks-btn" class="tool-btn" title="書籤管理">🔖</button>
            <button id="lib-history-btn" class="tool-btn" title="閱讀歷史">📖</button>
        </div>
    </div>

    <!-- 閱讀器模式 -->
    <div id="reader-view" class="view">
        <div class="reader-container" id="reader-container">
            <!-- 左區點擊（上一頁） -->
            <div class="click-area left" id="prev-area"></div>
            
            <!-- 中區點擊（顯示工具列） -->
            <div class="click-area center" id="center-area"></div>
            
            <!-- 右區點擊（下一頁） -->
            <div class="click-area right" id="next-area"></div>

            <!-- 圖片顯示區 -->
            <div id="page-display" class="page-display">
                <img id="current-page" class="page-image" alt="當前頁">
            </div>
        </div>

        <!-- 固定工具列 -->
        <div id="toolbar" class="toolbar">
            <button id="settings-btn" class="tool-btn" title="設定 (S)">⚙️</button>
            <button id="bookmark-btn" class="tool-btn" title="書籤 (B)">🔖</button>
            <button id="zoom-btn" class="tool-btn" title="放大鏡 (M)">🔍</button>
            <button id="auto-scroll-btn" class="tool-btn" title="自動捲動 (符合寬度)">📜</button>
			<button id="auto-page-btn" class="tool-btn" title="⏭️ 自動翻頁 (符合高度)">⏭️</button>

            <div class="progress-info">
                <span id="page-info">1/1</span>
                <input type="range" id="progress-slider" min="1" max="1" value="1">
                <span id="progress-percent">0%</span>
            </div>
<button id="stats-btn" class="tool-btn" title="📊 統計">📊</button>
<button id="page-mode-toggle-btn" class="tool-btn" title="單頁/雙頁 (D)">📖</button>
<button id="fullscreen-btn" class="tool-btn" title="全屏 (F)">⛶</button>
<button id="close-reader-btn" class="tool-btn" title="❌ 返回書架 (ESC)">❌</button>
        </div>
    </div>

    <!-- ==================== 以下所有 Panel 移到外面，全域可用 ==================== -->

    <!-- 設定面板（Material 風格） -->
<div id="settings-panel" class="panel settings-window hidden">
    <div class="panel-header">
        <h3>⚙️ 設定</h3>
        <button class="close-panel">✕</button>
    </div>
    
    <!-- 📌 分頁標籤 -->
    <div class="settings-tabs">
        <button class="tab-btn active" data-tab="display">📖 顯示</button>
        <button class="tab-btn" data-tab="control">🎮 操作</button>
        <button class="tab-btn" data-tab="backup">💾 備份</button>
    </div>
    
    <div class="panel-content settings-content">
        <!-- 📖 顯示設定 -->
        <div class="tab-content active" data-tab="display">
            <div class="settings-grid">
                <div class="settings-column">
                    <div class="setting-section">
                        <h4 class="section-title">📄 頁面模式</h4>
                        <label class="radio-label">
                            <input type="radio" name="page-mode" value="single" checked>
                            <span>單頁模式</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="page-mode" value="double">
                            <span>雙頁模式</span>
                        </label>
                    </div>
                    
                    <div class="setting-section">
                        <h4 class="section-title">📐 縮放模式</h4>
                        <label class="radio-label">
                            <input type="radio" name="fit-mode" value="width" checked>
                            <span>符合寬度</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="fit-mode" value="height">
                            <span>符合高度</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="fit-mode" value="original">
                            <span>原始大小</span>
                        </label>
                    </div>
                </div>
                
                <div class="settings-column">
                    <div class="setting-section">
                        <h4 class="section-title">🔄 旋轉角度</h4>
                        <select id="rotate-select" class="setting-select-full">
                            <option value="0" selected>0°（正常）</option>
                            <option value="90">90°</option>
                            <option value="180">180°</option>
                            <option value="270">270°</option>
                        </select>
                    </div>
                    
                    <div class="setting-section">
                        <h4 class="section-title">🔎 放大鏡尺寸</h4>
                        <select id="zoom-size-select" class="setting-select-full">
                            <option value="small">小 (120x180)</option>
                            <option value="medium" selected>中 (160x240)</option>
                            <option value="large">大 (200x300)</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 🎮 操作設定 -->
        <div class="tab-content" data-tab="control">
            <div class="settings-grid">
                <div class="settings-column">
                    <div class="setting-section">
                        <h4 class="section-title">📖 閱讀方向</h4>
                        <label class="radio-label">
                            <input type="radio" name="reading-direction" value="ltr" checked>
                            <span>從左到右 →</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="reading-direction" value="rtl">
                            <span>從右到左 ←</span>
                        </label>
                    </div>
                    
                    <div class="setting-section">
                        <h4 class="section-title">📜 自動捲動速度</h4>
                        <select id="scroll-speed-select" class="setting-select-full">
                            <option value="0.5">0.5（慢）</option>
                            <option value="1" selected>1.0（正常）</option>
                            <option value="2">2.0（快）</option>
                            <option value="3">3.0（很快）</option>
                        </select>
                        <button id="reset-scroll-btn" class="btn-small">🔄 重置速度</button>
                    </div>
                </div>
                
                <div class="settings-column">
                    <div class="setting-section">
                        <h4 class="section-title">⏱️ 自動翻頁間隔</h4>
                        <select id="auto-page-interval-select" class="setting-select-full">
                            <option value="3">3 秒</option>
                            <option value="5">5 秒</option>
                            <option value="8" selected>8 秒（推薦）</option>
                            <option value="10">10 秒</option>
                            <option value="15">15 秒</option>
                            <option value="20">20 秒</option>
                        </select>
                        <p style="font-size: 12px; color: var(--text-secondary); margin-top: 8px;">
                            ⚠️ 只在「符合高度」模式下有效
                        </p>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- 💾 備份設定 -->
        <div class="tab-content" data-tab="backup">
            <div class="settings-grid" style="grid-template-columns: 1fr;">
                <div class="settings-column" style="max-width: 500px; margin: 0 auto;">
                    <div class="setting-section">
                        <h4 class="section-title">📤 匯出資料</h4>
                        <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 12px;">
                            匯出閱讀記錄和書籤為 JSON 文件
                        </p>
                        <button id="export-backup-btn" class="btn-small">📤 匯出備份</button>
                    </div>
                    
                    <div class="setting-section">
                        <h4 class="section-title">📥 匯入資料</h4>
                        <p style="font-size: 14px; color: var(--text-secondary); margin-bottom: 12px;">
                            從備份文件還原資料（會覆蓋現有記錄）
                        </p>
                        <button id="import-backup-btn" class="btn-small">📥 匯入備份</button>
                        <input type="file" id="import-file-input" accept=".json" style="display: none">
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="panel-footer">
        <button id="settings-cancel-btn" class="btn-footer btn-cancel">取消</button>
        <button id="settings-confirm-btn" class="btn-footer btn-confirm">確定</button>
    </div>
</div>
                
                <!-- 右欄 -->
                <div class="settings-column">
                    <div class="setting-section">
                        <h4 class="section-title">旋轉頁面</h4>
                        <select id="rotate-select" class="setting-select-full">
                            <option value="0" selected>0°</option>
                            <option value="90">90°</option>
                            <option value="180">180°</option>
                            <option value="270">270°</option>
                        </select>
                    </div>
                    
                    <div class="setting-section">
                        <h4 class="section-title">放大鏡尺寸</h4>
                        <select id="zoom-size-select" class="setting-select-full">
                            <option value="small">小 (120x180)</option>
                            <option value="medium" selected>中 (160x240)</option>
                            <option value="large">大 (200x300)</option>
                        </select>
                    </div>
                    
                    <div class="setting-section">
                        <h4 class="section-title">自動捲動速度</h4>
                        <select id="scroll-speed-select" class="setting-select-full">
                            <option value="0.5">很慢</option>
                            <option value="1" selected>正常</option>
                            <option value="2">快</option>
                            <option value="3">很快</option>
                        </select>
						<div class="setting-section">
    <h4 class="section-title">⏭️ 自動翻頁間隔</h4>
    <select id="auto-page-interval-select" class="setting-select-full">
        <option value="3">3 秒</option>
        <option value="5">5 秒</option>
        <option value="8" selected>8 秒（推薦）</option>
        <option value="10">10 秒</option>
        <option value="15">15 秒</option>
        <option value="20">20 秒</option>
    </select>
    <p style="font-size: 12px; color: var(--text-secondary); margin-top: 8px;">
        ⚠️ 只在「符合高度」模式下有效
    </p>
</div>

                        <button id="reset-scroll-btn" class="btn-small">🔄 重置速度</button>
                    </div>
                </div>
            </div>
        </div>
            <!-- 🆕 新增第二行設定 -->
            <div class="settings-grid" style="margin-top: 20px;">
                <!-- 左欄 -->
                <div class="settings-column">
                    <!-- 🆕 翻頁方向 -->
                    <div class="setting-section">
                        <h4 class="section-title">📖 翻頁方向</h4>
                        <label class="radio-label">
                            <input type="radio" name="reading-direction" value="ltr" checked>
                            <span>← 從左到右（預設）</span>
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="reading-direction" value="rtl">
                            <span>→ 從右到左（日漫）</span>
                        </label>
                    </div>
                </div>
                
                <!-- 右欄 -->
                <div class="settings-column">
                    <!-- 🆕 備份功能 -->
                    <div class="setting-section">
                        <h4 class="section-title">💾 備份管理</h4>
                        <button id="export-backup-btn" class="btn-small" style="margin-bottom: 10px;">📤 匯出備份</button>
                        <button id="import-backup-btn" class="btn-small">📥 匯入備份</button>
                        <input type="file" id="import-file-input" accept=".json" style="display: none;">
                    </div>
                </div>
            </div>        
        <!-- 底部按鈕 -->
        <div class="panel-footer">
            <button id="settings-cancel-btn" class="btn-footer btn-cancel">取消</button>
            <button id="settings-confirm-btn" class="btn-footer btn-confirm">確定</button>
        </div>
    </div>

    <!-- 書籤管理面板 -->
    <div id="bookmarks-panel" class="panel hidden">
        <div class="panel-header">
            <h3>🔖 書籤管理</h3>
            <button class="close-panel">✕</button>
        </div>
        <div class="panel-content" id="bookmarks-list">
            <p class="hint">尚無書籤</p>
        </div>
    </div>

    <!-- 快捷鍵說明面板 -->
    <div id="shortcuts-panel" class="panel hidden">
        <div class="panel-header">
            <h3>⌨️ 快捷鍵說明</h3>
            <button class="close-panel">✕</button>
        </div>
        <div class="panel-content">
            <table style="width: 100%; font-size: 14px;">
                <tr><td><strong>← →</strong></td><td>上一頁 / 下一頁</td></tr>
                <tr><td><strong>Space</strong></td><td>下一頁</td></tr>
                <tr><td><strong>Home / End</strong></td><td>第一頁 / 最後一頁</td></tr>
                <tr><td><strong>B</strong></td><td>加入/移除書籤</td></tr>
                <tr><td><strong>M</strong></td><td>放大鏡</td></tr>
                <tr><td><strong>F</strong></td><td>全螢幕</td></tr>
                <tr><td><strong>N</strong></td><td>夜間模式</td></tr>
                <tr><td><strong>S</strong></td><td>設定</td></tr>
                <tr><td><strong>R</strong></td><td>旋轉頁面</td></tr>
                <tr><td><strong>+ / -</strong></td><td>調整捲動速度</td></tr>
                <tr><td><strong>ESC</strong></td><td>返回書架</td></tr>
            </table>
        </div>
    </div>

    <!-- 預載圖片容器（隱藏） -->
    <div id="preload-container" style="display:none;"></div>

    <!-- 腳本 -->
    <script src="https://cdn.jsdelivr.net/npm/jszip@3.10.1/dist/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/localforage@1.10.0/dist/localforage.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
